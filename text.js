const state = [ 
    {
        id: 1,
        question: "How are you feeling today, on a scale of 1 to 10?",
        answer: "",
        feeling_predict: [
            [
                {
                    label: "sadness",
                    score: 0.11600993573665619
                },
                {
                    label: "disgust",
                    score: 0.10262160748243332
                },
                {
                    label: "anger",
                    score: 0.06371620297431946
                },
                {
                    label: "joy",
                    score: 0.0573124960064888
                },
                {
                    label: "fear",
                    score: 0.049807850271463394
                },
                {
                    label: "optimism",
                    score: 0.04036574438214302
                },
                {
                    label: "anticipation",
                    score: 0.038538116961717606
                },
                {
                    label: "pessimism",
                    score: 0.03798834607005119
                },
                {
                    label: "surprise",
                    score: 0.0070303152315318584
                },
                {
                    label: "trust",
                    score: 0.005696910433471203
                },
                {
                    label: "love",
                    score: 0.003994685132056475
                }
            ]
        ]
    },
    {
        id: 2,
        question: "What is the main source of your current feelings?",
        answer: "",
        feeling_predict: [
            [
                {
                    label: "sadness",
                    score: 0.3096254765987396
                },
                {
                    label: "fear",
                    score: 0.15750186145305634
                },
                {
                    label: "disgust",
                    score: 0.09750259667634964
                },
                {
                    label: "pessimism",
                    score: 0.07018525898456573
                },
                {
                    label: "anticipation",
                    score: 0.05853438749909401
                },
                {
                    label: "anger",
                    score: 0.034669533371925354
                },
                {
                    label: "joy",
                    score: 0.022775854915380478
                },
                {
                    label: "surprise",
                    score: 0.015042205341160297
                },
                {
                    label: "optimism",
                    score: 0.011114872060716152
                },
                {
                    label: "trust",
                    score: 0.0035457804333418608
                },
                {
                    label: "love",
                    score: 0.0027719789650291204
                }
            ]
        ]
    },
    {
        id: 3,
        question: "In your main source of feelings, do you often feel stressed or overwhelmed?",
        answer: "",
        feeling_predict: [
            [
                {
                    label: "sadness",
                    score: 0.3096254765987396
                },
                {
                    label: "fear",
                    score: 0.15750186145305634
                },
                {
                    label: "disgust",
                    score: 0.09750259667634964
                },
                {
                    label: "pessimism",
                    score: 0.07018525898456573
                },
                {
                    label: "anticipation",
                    score: 0.05853438749909401
                },
                {
                    label: "anger",
                    score: 0.034669533371925354
                },
                {
                    label: "joy",
                    score: 0.022775854915380478
                },
                {
                    label: "surprise",
                    score: 0.015042205341160297
                },
                {
                    label: "optimism",
                    score: 0.011114872060716152
                },
                {
                    label: "trust",
                    score: 0.0035457804333418608
                },
                {
                    label: "love",
                    score: 0.0027719789650291204
                }
            ]
        ]
    },
    {
        id: 4,
        question: "What is your main coping mechanism when you feel stressed or overwhelmed?",
        answer: "",
        feeling_predict: [
            [
                {
                    label: "sadness",
                    score: 0.43615302443504333
                },
                {
                    label: "fear",
                    score: 0.2747052013874054
                },
                {
                    label: "disgust",
                    score: 0.13725246489048004
                },
                {
                    label: "pessimism",
                    score: 0.11530410498380661
                },
                {
                    label: "anticipation",
                    score: 0.05589523911476135
                },
                {
                    label: "anger",
                    score: 0.04354393854737282
                },
                {
                    label: "surprise",
                    score: 0.016495870426297188
                },
                {
                    label: "joy",
                    score: 0.013630775734782219
                },
                {
                    label: "optimism",
                    score: 0.009829605929553509
                },
                {
                    label: "trust",
                    score: 0.004096332471817732
                },
                {
                    label: "love",
                    score: 0.002671436406672001
                }
            ]
        ]
    },
    {
        id: 5,
        question: "How much support do you feel you receive from the people closest to you?",
        answer: "",
        feeling_predict: [
            [
                {
                    label: "sadness",
                    score: 0.43615302443504333
                },
                {
                    label: "fear",
                    score: 0.2747052013874054
                },
                {
                    label: "disgust",
                    score: 0.13725246489048004
                },
                {
                    label: "pessimism",
                    score: 0.11530410498380661
                },
                {
                    label: "anticipation",
                    score: 0.05589523911476135
                },
                {
                    label: "anger",
                    score: 0.04354393854737282
                },
                {
                    label: "surprise",
                    score: 0.016495870426297188
                },
                {
                    label: "joy",
                    score: 0.013630775734782219
                },
                {
                    label: "optimism",
                    score: 0.009829605929553509
                },
                {
                    label: "trust",
                    score: 0.004096332471817732
                },
                {
                    label: "love",
                    score: 0.002671436406672001
                }
            ]
        ]
    },
    {
        id: 6,
        question: "How would you rate your self-esteem within the context of your main stress source?",
        answer: "",
        feeling_predict: [
            [
                {
                    label: "sadness",
                    score: 0.43615302443504333
                },
                {
                    label: "fear",
                    score: 0.2747052013874054
                },
                {
                    label: "disgust",
                    score: 0.13725246489048004
                },
                {
                    label: "pessimism",
                    score: 0.11530410498380661
                },
                {
                    label: "anticipation",
                    score: 0.05589523911476135
                },
                {
                    label: "anger",
                    score: 0.04354393854737282
                },
                {
                    label: "surprise",
                    score: 0.016495870426297188
                },
                {
                    label: "joy",
                    score: 0.013630775734782219
                },
                {
                    label: "optimism",
                    score: 0.009829605929553509
                },
                {
                    label: "trust",
                    score: 0.004096332471817732
                },
                {
                    label: "love",
                    score: 0.002671436406672001
                }
            ]
        ]
    },
    {
        id: 7,
        question: "Considering all aspects of your life, how satisfied are you currently?",
        answer: "",
        feeling_predict: [
            [
                {
                    label: "sadness",
                    score: 0.3558560311794281
                },
                {
                    label: "fear",
                    score: 0.13843901455402374
                },
                {
                    label: "disgust",
                    score: 0.1270184963941574
                },
                {
                    label: "pessimism",
                    score: 0.07697009295225143
                },
                {
                    label: "anticipation",
                    score: 0.05307695269584656
                },
                {
                    label: "anger",
                    score: 0.0465056411921978
                },
                {
                    label: "joy",
                    score: 0.020393162965774536
                },
                {
                    label: "surprise",
                    score: 0.013294619508087635
                },
                {
                    label: "optimism",
                    score: 0.009209048002958298
                },
                {
                    label: "trust",
                    score: 0.0029621566645801067
                },
                {
                    label: "love",
                    score: 0.002538467990234494
                }
            ]
        ]
    }
]
const prediction_array = state.map((question) => question.feeling_predict )
let feeling_classification= {}
prediction_array.forEach(prediction => {
    
const question_feeling = prediction

for (feeling of question_feeling ) {
    // console.log(feeling)
    console.log(feeling_classification[feeling.label])
    const current_feeling = feeling
    for (label of current_feeling){
        if (feeling_classification[label.label]) {
            feeling_classification[label.label] = [...feeling_classification[label.label], label.score]
            }
            else {
            feeling_classification[label.label] = [label.score]
            }
    }
    //  
}

});
// console.log(feeling_classification)
const final_state = {};
for (const key in feeling_classification) {
  const arr = feeling_classification[key];
  const average = arr.reduce((a, b) => a + b, 0) / arr.length;
  final_state[key] = average;
}
console.log(final_state)
// Step 1: Convert the final_state object into an array of key-value pairs
const dataArray = Object.entries(final_state);

// Step 2: Sort the array based on the values in descending order
dataArray.sort((a, b) => b[1] - a[1]);

// Step 3: Retrieve only the keys from the sorted array
const maxKeys = dataArray.slice(0, 2).map(([key, value]) => key);

console.log(maxKeys);